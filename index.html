<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>건설 예산 검증 서비스</title>
    <!-- Pretendard Font -->
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@400;500;600&display=swap">
</head>
    <body>
        <!-- 네비게이션 바 -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
        <div class="container">
            <div class="navbar-nav d-flex align-items-center">
                <img src="css/logo.png" alt="로고" style="width: 100px; height: 100px; margin-right: 109px;">
                <a class="nav-link active" href="#" data-tab="home" style="margin-right: 45px;">홈</a>
                <a class="nav-link" href="#" data-tab="upload" style="margin-right: 45px;">업로드</a>
                <a class="nav-link" href="#" data-tab="dashboard" style="margin-right: 45px;">대시보드</a>
            </div>
        </div>
    </nav>

    <!-- 메인 콘텐츠 영역 -->
    <main id="mainContent">
        <!-- 홈 탭 -->
        <div id="homeTab" class="tab-content active">
            <!-- 히어로 섹션 -->
            <section class="hero-section" style="padding-top: 211px;">
                <video class="hero-video" autoplay muted loop playsinline>
                    <source src="css/background-4.webm" type="video/webm">
                </video>
                <div class="container">
                    <div class="row">
                        <div class="col-lg-10 mx-auto text-center">
                            <h1 class="hero-title" style="margin-bottom: 22px;">
                                "공사원가 예산서, 더이상 불안해하지 마세요"
                            </h1>
                            <h2 class="hero-subtitle" style="margin-bottom: 100px;">건설 예산 검증 서비스, <span class="costchecker-highlight">CostChecker</span>입니다.</h2>
                            <p class="hero-description" style="margin-bottom: 113px;">
                                정부고시 표준단가를 기반해서 예산 내역서를 자동으로 검증합니다.<br>
                                간단한 파일 업로드만으로 최신 표준단가와 비교, 검토해서 누락, 오차를 방지하세요.
                            </p>
                            <button class="btn btn-start" onclick="switchTab('upload')">
                                지금 시작하기
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 어두운 배경 섹션 -->
            <section class="dark-section">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-8">
                            <h2 class="dark-title mb-4">
                                작은 실수여도<br>
                                책임은 클 수 있습니다.
                            </h2>
                            <p class="dark-subtitle mb-4">
                                표준가격과 어긋나있는 단가,<br>
                                작은 숫자의 차이로 프로젝트의 일정, 비용, 신뢰와 평판까지 무너질 수 있습니다.
                            </p>
                            <p class="dark-description mb-4">
                                이 현대적인 웹 서비스는 설계 회사들이 국가 공시 단가와 비교하여 건설 예산 견적을 검증하는 데 도움을 줍니다.
                            </p>
                            <p class="dark-description mb-4">
                                사용자들은 분석을 위해 엑셀 또는 PDF 형식의 견적 파일을 업로드할 수 있습니다.
                            </p>
                            <p class="dark-description mb-4">
                                이 애플리케이션은 불일치, 오류를 강조하고 수정 및 검증을 위한 도구를 제공하는 포괄적인 대시보드를 제공합니다.
                            </p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 기능 소개 섹션 -->
            <section class="features-section" style="padding: 100px 0; background-image: url('css/nowback.png'); background-size: cover; background-position: center; background-repeat: no-repeat; background-attachment: fixed;">
                <div class="container">
                    <div class="row">
                        <div class="col-12 text-center mb-5">
                            <h2 class="features-title" style="color: #202020; text-align: center; font-family: Pretendard; font-size: 40px; font-style: normal; font-weight: 700; line-height: normal; letter-spacing: 1.2px; margin-bottom: 20px;">
                                이제는 더 편리하게
                            </h2>
                        </div>
                    </div>

                    <div class="row justify-content-center">
                        <div class="col-lg-4 col-md-6 mb-4">
                            <div class="feature-card" style="width: 100%; height: 396px; flex-shrink: 0; border-radius: 30px; background: #FFF; padding: 50px; text-align: left; box-shadow: 0 15px 40px rgba(0,0,0,0.15);">
                                <div class="card-content">
                                    <h3 class="card-title" style="color: #262626; font-family: Pretendard; font-size: 24px; font-style: normal; font-weight: 700; line-height: 1.5; margin-bottom: 45px;">
                                        최신 정부고시 표준단가 반영<br>
                                        실시간 연동
                                    </h3>
                                    <hr style="border: none; height: 1px; background: rgba(0,0,0,0.1); margin: 30px 0; margin-bottom: 45px;">
                                    <p class="card-description" style="color: var(--B2, #4C5661); font-family: Pretendard; font-size: 20px; font-style: normal; font-weight: 400; line-height: 1.8; margin: 0;">
                                        매년 업데이트 되는<br>
                                        표준단가의 최신버전과 예산항목을<br>
                                        매칭해 자동으로 비교해드립니다.
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-6 mb-4">
                            <div class="feature-card" style="width: 100%; height: 396px; flex-shrink: 0; border-radius: 30px; background: #FFF; padding: 50px; text-align: left; box-shadow: 0 15px 40px rgba(0,0,0,0.15);">
                                <div class="card-content">
                                    <h3 class="card-title" style="color: #262626; font-family: Pretendard; font-size: 24px; font-style: normal; font-weight: 700; line-height: 1.5; margin-bottom: 45px;">
                                        보다 편하고 빠른 재검토<br>
                                        <br>

                                    </h3>
                                    <hr style="border: none; height: 1px; background: rgba(0,0,0,0.1); margin: 30px 0; margin-bottom: 45px;">
                                    <p class="card-description" style="color: var(--B2, #4C5661); font-family: Pretendard; font-size: 20px; font-style: normal; font-weight: 400; line-height: 1.8; margin: 0;">
                                        Solar Pro2 AI 기술을 활용하여<br>
                                        품명과 규격을 정확하게 분석하고<br>
                                        표준공사코드와 매칭해드립니다.
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-6 mb-4">
                            <div class="feature-card" style="width: 100%; height: 396px; flex-shrink: 0; border-radius: 30px; background: #FFF; padding: 50px; text-align: left; box-shadow: 0 15px 40px rgba(0,0,0,0.15);">
                                <div class="card-content">
                                    <h3 class="card-title" style="color: #262626; font-family: Pretendard; font-size: 24px; font-style: normal; font-weight: 700; line-height: 1.5; margin-bottom: 45px;">
                                        책임의 불안을 줄인다<br>
                                        <br>

                                    </h3>
                                    <hr style="border: none; height: 1px; background: rgba(0,0,0,0.1); margin: 30px 0; margin-bottom: 45px;">
                                    <p class="card-description" style="color: var(--B2, #4C5661); font-family: Pretendard; font-size: 20px; font-style: normal; font-weight: 400; line-height: 1.8; margin: 0;">
                                        전문가에게 맡겼더라도 불안했던 마음,<br>
                                        이제는 스스로 검증해 안심하세요
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 새로운 큰 카드 섹션 -->
            <section class="large-card-section" style="padding: 100px 0 100px 0; background-image: url('css/nowback.png'); background-size: cover; background-position: center; background-repeat: no-repeat; background-attachment: fixed;">
                <div class="container">
                    <div class="row justify-content-center">
                        <div class="col-auto">
                            <div class="large-card" style="width: 1317px; min-height: 952px; flex-shrink: 0; border-radius: 30px; border: 1px solid #D6DBE5; background: #FFF; box-shadow: 0 4px 7.2px 1px #D6DBE5; padding: 80px; text-align: left;">
                                <div class="card-content">
                                    <h2 class="card-main-title" style="color: #202020; font-family: Pretendard; font-size: 40px; font-style: normal; font-weight: 700; line-height: normal; letter-spacing: 1.2px; margin-bottom: 40px;">
                                        한 눈에 쉽게 보는 오차 검증
                                    </h2>
                                    <p class="card-main-description" style="color: #798089; font-family: Pretendard; font-size: 20px; font-style: normal; font-weight: 400; line-height: normal; margin: 0; margin-bottom: 40px;">
                                        조달청 고시 표준단가 데이터와 AI 기술을 활용해 예산서 파일 안의 단가 오류를 검증합니다.<br>
                                        오류 데이터들을 정리해 결과를 한 눈에 보기 좋고, 보고서 형식으로 받아볼 수도 있습니다.
                                    </p>
                                    <img src="css/mock.png" alt="Mock Image" style="width: 100%; max-width: 100%; height: auto; border-radius: 15px;">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- 업로드 탭 -->
        <div id="uploadTab" class="tab-content">
            <div class="container py-5">
                <div class="row">
                    <div class="col-lg-8 mx-auto">
                        <div class="text-center mb-5">
                            <h2 class="mb-3">Excel 파일 업로드</h2>
                            <p class="text-muted">표준공사코드 매칭을 위해 Excel 파일을 업로드해주세요.</p>
                        </div>
                        
                        <!-- 파일 업로드 영역 -->
                        <div class="card border-0 shadow-sm">
                            <div class="card-body p-5">
                                <div id="uploadArea" class="upload-area text-center p-5 border-2 border-dashed border-secondary rounded">
                                    <img src="css/icon.png" style="width: 51px; height: 57px; object-fit: contain; margin-bottom: 1.5rem;">
                                    <h5 class="mb-3">파일을 드래그하거나 클릭하여 업로드</h5>
                                    <p class="text-muted mb-3">Excel 파일 (.xlsx, .xls)만 지원됩니다.</p>
                                    <input type="file" id="fileInput" accept=".xlsx,.xls" style="display: none;">
                                </div>
                                
                                <!-- 파일 정보 표시 -->
                                <div id="fileInfo" class="mt-4" style="display: none;">
                                    <div class="alert alert-info">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <strong>선택된 파일:</strong> <span id="fileName"></span>
                                                <br>
                                                <small class="text-muted">크기: <span id="fileSize"></span></small>
                                            </div>
                                            <button class="btn btn-sm btn-outline-danger" onclick="removeFile()">
                                                <i class="fas fa-times"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- 업로드 버튼 -->
                                <div class="text-center mt-4">
                                    <button id="uploadBtn" class="btn btn-primary btn-lg px-5" onclick="processFile()" style="display: none;">
                                        표준공사코드 매칭하기
                                    </button>
                                </div>
                                
                                <!-- 진행률 표시 -->
                                <div id="progressContainer" class="mt-4" style="display: none;">
                                    <div class="progress mb-3">
                                        <div id="progressBar" class="progress-bar progress-bar-striped progress-bar-animated" style="width: 0%"></div>
                                    </div>
                                    <p id="progressText" class="text-center text-muted mb-0">처리 중...</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 가이드 -->
                        <div class="card border-0 shadow-sm mt-4">
                            <div class="card-header bg-light">
                                <h5 class="mb-0">
                                    업로드 가이드
                                </h5>
                            </div>
                            <div class="card-body">
                                <ul class="list-unstyled mb-0">
                                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>필수 컬럼: 품명, 규격, 단위, 재료비</li>
                                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>재료비가 0원인 품목은 제외됩니다</li>
                                    <li class="mb-2"><i class="fas fa-check text-success me-2"></i>파일 크기는 10MB 이하여야 합니다</li>
                                    <li><i class="fas fa-check text-success me-2"></i>처리 완료 후 대시보드로 자동 이동됩니다</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 대시보드 탭 -->
        <div id="dashboardTab" class="tab-content">
            <div class="container py-5">
                <div id="dashboardContent">
                    <!-- 파일 업로드 안내 -->
                    <div id="noDataMessage" class="text-center py-5">
                        <i class="fas fa-file-excel fa-4x text-muted mb-4"></i>
                        <h3 class="mb-3">데이터가 없습니다</h3>
                        <p class="text-muted mb-4">표준공사코드 매칭 결과를 확인하려면 먼저 Excel 파일을 업로드해주세요.</p>
                        <button class="btn btn-primary btn-lg" onclick="switchTab('upload')">
                            <i class="fas fa-upload me-2"></i>파일 업로드하기
                        </button>
                    </div>
                    
                    <!-- 결과 표시 영역 -->
                    <div id="resultContent" style="display: none;">
                        <!-- 요약 통계 카드 -->
                        <div class="row mb-5">
                            <div class="col-md-3 mb-3">
                                <div class="card stat-card">
                                    <div class="card-body text-center">
                                        <h6 class="card-title text-muted">전체 항목</h6>
                                        <h2 class="stat-number">2000개</h2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="card stat-card">
                                    <div class="card-body text-center">
                                        <h6 class="card-title text-muted">단가오류</h6>
                                        <h2 class="stat-number text-danger">10</h2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="card stat-card">
                                    <div class="card-body text-center">
                                        <h6 class="card-title text-muted">인식오류</h6>
                                        <h2 class="stat-number">2</h2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="card stat-card">
                                    <div class="card-body text-center">
                                        <h6 class="card-title text-muted">수정 완료</h6>
                                        <h2 class="stat-number text-primary">2</h2>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 오류 보고서 -->
                        <div class="card mb-4">
                            <div class="card-header">
                                <h5 class="mb-0">오류 보고서</h5>
                            </div>
                            <div class="card-body p-0">
                                <div class="table-responsive">
                                    <table class="table table-hover mb-0">
                                        <thead class="table-light">
                                            <tr>
                                                <th>상태</th>
                                                <th>파일 품목명</th>
                                                <th>파일 기재 규격</th>
                                                <th>파일 범위</th>
                                                <th>파일 기입단가</th>
                                                <th>표준 품목명</th>
                                                <th>표준 규격</th>
                                                <th>표준 범위</th>
                                                <th>표준 단가</th>
                                                <th>코드</th>
                                            </tr>
                                        </thead>
                                        <tbody id="errorReportTable">
                                            <!-- 동적으로 생성될 내용 -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- 전체 검증 보고서 -->
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">전체 검증 보고서</h5>
                            </div>
                            <div class="card-body p-0">
                                <div class="table-responsive">
                                    <table class="table table-hover mb-0">
                                        <thead class="table-light">
                                            <tr>
                                                <th>상태</th>
                                                <th>파일 품목명</th>
                                                <th>파일 기재 규격</th>
                                                <th>파일 범위</th>
                                                <th>파일 기입단가</th>
                                                <th>표준 품목명</th>
                                                <th>표준 규격</th>
                                                <th>표준 범위</th>
                                                <th>표준 단가</th>
                                                <th>코드</th>
                                            </tr>
                                        </thead>
                                        <tbody id="fullReportTable">
                                            <!-- 동적으로 생성될 내용 -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 푸터 -->
    <footer class="bg-dark text-white py-20 mt-100" style="padding-top: 50px; padding-bottom: 50px;">
        <div class="container">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0 text-center">&copy; CostChecker from OMORI BLUE. All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- SheetJS 라이브러리 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- 커스텀 스크립트 -->
    <script src="js/app.js"></script>
    <script src="js/upload.js"></script>
    <script src="js/dashboard.js"></script>
</body>
</html>
